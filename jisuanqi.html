<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>简易网页计算器</title>
  <style>
    :root {
      --bg: #0f172a; /* slate-900 */
      --card: #1e293b; /* slate-800 */
      --text: #e2e8f0; /* slate-200 */
      --accent: #60a5fa; /* blue-400 */
      --danger: #ef4444; /* red-500 */
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Segoe UI Emoji";
      background: linear-gradient(135deg, #0f172a, #111827);
      color: var(--text);
      display: grid;
      place-items: center;
      min-height: 100vh;
    }
    .calculator {
      width: 100%;
      max-width: 460px;
      background: var(--card);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.4), inset 0 0 0 1px rgba(255,255,255,0.05);
    }
    h1 { font-size: 20px; margin: 0 0 16px; }
    .row { display: grid; grid-template-columns: 1fr 80px 1fr; gap: 10px; align-items: center; }
    input[type="number"], select {
      width: 100%;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.1);
      background: rgba(255,255,255,0.06);
      color: var(--text);
      outline: none;
    }
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    .actions { margin-top: 12px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
    button {
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.08);
      color: var(--text);
      cursor: pointer;
      transition: transform .05s ease, background .2s ease;
    }
    button:hover { background: rgba(255,255,255,0.12); }
    button:active { transform: translateY(1px); }
    .equals { grid-column: span 4; background: #1d4ed8; border-color: #1d4ed8; }
    .equals:hover { background: #2563eb; }
    .result { margin-top: 14px; padding: 12px 14px; border-radius: 12px; background: rgba(255,255,255,0.06); min-height: 44px; }
    .error { color: var(--danger); font-weight: 600; }
    footer { margin-top: 10px; font-size: 12px; opacity: 0.7; }
    /* 可聚焦元素的可见样式 */
    input:focus, select:focus, button:focus { box-shadow: 0 0 0 3px rgba(96,165,250,0.15); outline: none; }
  </style>
</head>
<body>
  <div class="calculator" aria-label="简易网页计算器">
    <h1>简易网页计算器（加/减/乘/除）</h1>

    <form id="calcForm" aria-describedby="hint">
      <div class="row">
        <input id="numA" name="numA" type="number" inputmode="decimal" step="any" placeholder="第一个数" aria-label="第一个数" autocomplete="off" />
        <select id="op" name="op" aria-label="运算符">
          <option value="+">＋</option>
          <option value="-">－</option>
          <option value="*">×</option>
          <option value="/">÷</option>
        </select>
        <input id="numB" name="numB" type="number" inputmode="decimal" step="any" placeholder="第二个数" aria-label="第二个数" autocomplete="off" />
      </div>

      <div class="actions" role="group" aria-label="快速运算">
        <button type="button" data-op="+">加</button>
        <button type="button" data-op="-">减</button>
        <button type="button" data-op="*">乘</button>
        <button type="button" data-op="/">除</button>
        <button class="equals" id="btnCalc" type="submit">计算</button>
      </div>
    </form>

    <div id="result" class="result" role="status" aria-live="polite"></div>
    <footer id="hint">提示：输入数字，选择运算或点击对应按钮，支持键盘 Enter 计算。</footer>
  </div>

  <script>
    const numA = document.getElementById('numA');
    const numB = document.getElementById('numB');
    const opSel = document.getElementById('op');
    const resultEl = document.getElementById('result');
    const btnCalc = document.getElementById('btnCalc');
    const form = document.getElementById('calcForm');

    // 更稳健的浮点显示：保留最多 12 个有效数字，去掉多余尾零，必要时使用指数表示
    function formatNumber(v) {
      if (!Number.isFinite(v)) return String(v);
      if (v === 0) return "0";
      const abs = Math.abs(v);
      // 对非常大或非常小的数使用指数表示（更易读）
      if (abs < 1e-9 || abs >= 1e12) {
        // 12 位有效数字的指数格式
        return Number(v).toExponential(12).replace(/(\.\d*?[1-9])0+e/, '$1e').replace(/\.0+e/,'e');
      }
      // 普通数值用有效数字表示并去掉末尾多余 0
      let s = Number(v).toPrecision(12);
      // 去掉末尾的无意义 0 和可能的点
      s = s.replace(/(?:\.0+|(\.\d+?)0+)$/, '$1');
      return s;
    }

    function calc(aStr, bStr, op) {
      const a = parseFloat(aStr);
      const b = parseFloat(bStr);
      if (Number.isNaN(a) || Number.isNaN(b)) {
        return { error: '请输入有效数字' };
      }
      if (op === '/' && b === 0) {
        return { error: '除数不能为 0' };
      }
      let value;
      switch (op) {
        case '+': value = a + b; break;
        case '-': value = a - b; break;
        case '*': value = a * b; break;
        case '/': value = a / b; break;
        default: return { error: '未知运算符' };
      }
      return { value: formatNumber(value) };
    }

    function show(res) {
      if (res.error) {
        resultEl.innerHTML = `<span class="error">${res.error}</span>`;
      } else {
        resultEl.textContent = `结果：${res.value}`;
      }
    }

    // 阻止表单默认提交（防止页面刷新），并计算
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      show(calc(numA.value, numB.value, opSel.value));
    });

    // 快捷按钮也能触发计算
    document.querySelectorAll('button[data-op]').forEach(btn => {
      btn.addEventListener('click', () => {
        opSel.value = btn.getAttribute('data-op');
        show(calc(numA.value, numB.value, opSel.value));
      });
    });

    // 回车在输入框触发表单 submit（已由 form 处理）
    [numA, numB, opSel].forEach(el => {
      el.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          // 使用 form.submit 会触发 submit 事件；这里直接防止重复行为
          e.preventDefault();
          show(calc(numA.value, numB.value, opSel.value));
        }
      });
    });
  </script>
</body>
</html>